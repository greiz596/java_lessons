В этом уроке ты узнаешь, как в автоматизации используют тестовые стенды.

**Тестовый стенд** — это копия реального приложения и его окружения: баз данных, конфигурационных файлов, вспомогательных сервисов или их моков. На тестовом стенде тестируют фичи, которых пока нет в реальном приложении.

Реальное приложение и его окружение называют **продуктивным**, или боевым стендом.

Тестовые стенды помогают проверить приложение в окружении, которое похоже на реальное. При этом тесты не влияют на продуктивный стенд и реальных пользователей.

Чтобы покрыть всё приложение проверками, данные для тестового стенда должны быть:

- **Актуальными** — это значит, что в тестовую базу переносят новые данные — например, товары из каталога интернет-магазина или ставку НДС.
- **Полными** — например, на тестовом стенде интернет-магазина должны быть все категории товаров, которые есть на продуктивном стенде.
- **Разнообразными** — например, почтовые индексы отделений в разных городах.

### Виды стендов

На проекте может быть один или несколько тестовых стендов. Где-то они доступны всей команде постоянно, а где-то работают только по необходимости — например, когда запускают автотесты.
![img.png](img%2Fimg.png)

Процесс работы над новыми фичами в этом проекте такой:

1. Разработчики создают новую функциональность на локальных стендах.
2. Каждую фичу тестируют на QA-стенде. QA-стендов может быть несколько: тогда можно протестировать фичу отдельно от других доработок или запустить только часть тестируемого приложения.
3. Перед релизом все фичи попадают на RC-стенд (англ. release candidate — «кандидат на релиз»). Там проводят регрессионное тестирование.
4. Функциональность попадает на продуктивный стенд.

### API-автотесты на тестовом стенде

Автотесты можно запустить на любом стенде — например, на стенде разработчиков или QA-стенде. Чем раньше запустишь автотесты, тем быстрее найдёшь баги и вернёшь функциональность на доработку.

Ты уже умеешь писать UI-автотесты. Для проверки UI нужна копия продуктивного стенда. Иногда хватает UI-части приложения и моков, которые имитируют работу бэкенда: тогда тесты могут имитировать действия пользователя.

Для API-автотестов тоже можно развернуть на QA-стенде только часть приложения, а не всё целиком.

Например, команда разрабатывает интернет-магазин с такой функциональностью:

- каталог товаров,
- личный кабинет пользователя,
- корзина для оформления заказов.

Чтобы создать приложение за короткий срок, можно реализовать **микросервисную архитектуру**. Это значит, что проект делится на несколько частей — **сервисов**. Ты узнаешь больше о микросервисной архитектуре в следующем спринте.

Бэкенд для каждой функциональности — это отдельный сервис с API-методами. Сервисы независимы, поэтому их можно тестировать по отдельности.

Представь, что тебе нужно протестировать сервис — личный кабинет пользователя. У него есть два API-метода: регистрация и аутентификация.
Автотест может выполнить API-методы: сначала отправить запрос на регистрацию и проверить ответ от сервера, а потом войти в личный кабинет под этим пользователем. Запускать другие сервисы не нужно.

API-тесты можно запустить на тестовом стенде так:

1. Выбрать ветку с доработками в репозитории сервиса.
2. Собрать код из этой ветки.
3. Подключиться к базе данных проекта или наполнить базу данных сервиса тестовыми данными. Обычно используют данные с продуктивного стенда — они самые актуальные и полные.
4. Запустить сервис на тестовом стенде.
5. Запустить автотесты, проверить сервис и сформировать отчёт.
6. Вернуть базу данных к исходному состоянию. Теперь на тестовом стенде можно запускать тесты для других сервисов.