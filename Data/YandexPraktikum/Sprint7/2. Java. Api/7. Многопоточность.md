Как ты знаешь из прошлого урока, в любом процессе есть хотя бы один поток. Например, в приложении для музыки — прослушивание трека.

Бывает, что потоков несколько. Например, слушать музыку и просматривать список новых треков. Такой процесс называется **многопоточным**.
Представь, что ты готовишь макароны и сосиски, но на плите только одна конфорка. Сначала придётся сварить макароны и выложить их на тарелку, а уже потом сварить сосиски.

Это **однопоточный процесс**. Он выполняет действия последовательно: сначала закончит одно, потом начнёт другое.

![img_3.png](img%2Fimg_3.png)

Теперь представь, что у тебя две конфорки. Можно варить одновременно и макароны, и сосиски. Это **двухпоточный процесс** с двумя потоками. Он ускоряет готовку.

Многопоточность помогает выполнять задачи быстрее.

![img_4.png](img%2Fimg_4.png)

Ты работаешь с программой для рендеринга: запускаешь обработку видео. Если программа однопоточная, придётся ждать конца обработки: всё остальное зависнет.

В многопоточном приложении ты можешь перемещаться по интерфейсу, менять настройки программы. Если мощности хватит, можно запустить рендеринг ещё одного видео.

Рендеринг и навигация по интерфейсу происходят в разных потоках.
Иногда потоки выполняют одну и ту же задачу.

Например, нужно сварить много макарон. Тогда можно поставить сразу две кастрюли с макаронами — каждую на свою конфорку.

Или программа рассылает письма многим адресатам. Можно сделать это последовательно: отправить одно письмо, следом другое. А можно разослать сразу несколько писем в разных потоках.

В любой запущенной программе есть поток `main`. Кроме него программист может создать и другие потоки: они станут «детьми» потока `main`.
![img_5.png](img%2Fimg_5.png)

Многопоточность нужно настраивать отдельно. Если программист этого не cделает, поток будет один — тот самый `main`. Cколько при этом в программе методов, не имеет значения.

Все программы, которые тебе встречались раньше, были однопоточными

### Свойства многопоточности

У многопоточности есть несколько свойств.

**Состояние гонки или конкуренция.** Представь, что один и тот же ресурс нужен нескольким потокам. Его заберёт поток, который доберётся до ресурса первым. Остальным придётся подождать.

Например, нужно посолить воду и для макарон, и для сосисок. По условиям ты не можешь сыпать соль одновременно в обе кастрюли.

Пока ты солишь макароны, сосиски будут ждать. Это и есть конкуренция.

Ещё пример. Первый поток запросил информацию у базы данных. Второй поток ждёт, пока база данных освободится и сможет ему ответить.

**Состояние дедлока.** Это взаимная блокировка: несколько потоков не могут работать, пока не получат друг от друга данные.

Например, первый поток хочет получить данные от второго. Второй — от третьего, а третий — от четвёртого. Четвёртому же нужно что-то от первого. Получается круговая зависимость. Программа зависает.

Пример дедлока из жизни — пробка на перекрёстке. Пока не сдвинется одна машина, не сможет проехать вторая, а третья не сможет сдвинуться с места из-за второй.

### Зачем многопоточность в автотестах

Если сделаешь автотесты атомарными, они не будут влиять друг на друга. И тогда они смогут свободно работать в несколько потоков. Тестирование пройдёт быстрее.

Программист управляет потоками: создаёт их, обозначает их задачи, командует притормозить или запуститься опять. Пока что ты не будешь создавать многопоточные программы — просто запомни общее определение.

В следующем уроке ты познакомишься асинхронностью. Эти понятия очень похожи — и их часто путают. Ты научишься их различать.