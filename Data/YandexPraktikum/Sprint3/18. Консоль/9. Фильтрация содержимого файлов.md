Что делать, если в каталоге несколько файлов логов, а ошибка — только в одном?

Можно открыть и просмотреть каждый файл по очереди либо «грепнуть» их — воспользоваться командой `grep` (global regular expression print).

**Grep** — это файловый поисковик, который применяют, чтобы искать определённые выражения в файлах. Он возвращает строки, в которых встречаются совпадения.

Если не указывать определённый файл, поиск выполнится по всем файлам в каталоге.

Как выглядит команда:
```
$ grep [Ключ(и)] PATTERN [Адрес] 
```

Вместо PATTERN нужно подставить то, что ищешь: одно слово или несколько. Например, «Фродо» или «Фродо Бэггинс». Если слов несколько, их нужно взять в кавычки — `""`. Будет так: `"Фродо Бэггинс"`. Для одного слова кавычки не нужны.

Вместо [Адрес] нужно поставить путь до файла.

Ключ(и) — это специальные символы, которые влияют на отображение и поиск информации. Например, показывают, что нужно проигнорировать регистр при поиске.

### Ключи команды

Ключ `–R` говорит о том, что надо искать внутри каталога.
```
$ grep -R DELETE ~/logs/2020/1 
```

Если добавить ключ `-n`, дополнительно отобразится номер строки.
```
$ grep -n DELETE apache_2020-01-01.txt 
```

1500

В некоторых случаях важно увидеть не только строку, но и окружающую информацию. Например, нужно посмотреть в логах, что происходило с приложением до ошибки.

Чтобы вывести соседние строки, применяй ключи `-B`, `-A` и `-C`.

|Ключ|Значение|
|---|---|
|-B, --before-context|Количество отображаемых строк до искомой|
|-A, --after-context|Количество отображаемых строк после искомой|
|-C, --context|Количество отображаемых строк до и после искомой одновременно|

Например:

`-C` со значением 1 выведет искомую строку и строки на одну выше и ниже искомой:
```
 $ grep -C 1 DELETE ~/logs/2020/1/apache_2020-01-01.txt 
```

### Шаблоны команды

Иногда слово DELETE записывается в логах в другом регистре или сокращено до DEL. В этом случае можешь применять:

- ключ `–i`, который игнорирует регистр;
- символ астериск `*`, который заменит любое количество любых символов, например:
```
$ grep -i DEL* ~/logs/2020/1/apache_2020-01-31.txt 
```


Иногда бывает, что ты не знаешь точное написание искомого слова. В этом случае примени квадратные скобки:
```
$ grep -i N[ua]m1 /test1/test2/test_Logs/Log1.txt 
```

Grep станет искать совпадения по шаблону, где на месте второго символа может быть как u, так и a. Например, Num1, Nam1, num1, nam1. Здесь ключ `-i` игнорирует регистр.

Другие полезные символы:

`.` — точка, заменяет один любой символ.

Пример:
```
$ grep "204 3.96" ~/logs/2020/1/apache_2020-01-01.txt
56.150.98.194 - - [1/1/2020:22:04:00 +0000] "POST /lists HTTP/1.1" 204 3996
72.32.174.237 - - [1/1/2020:22:12:52 +0000] "DELETE /users HTTP/1.1" 204 3196 
```

`^` — означает начало строки. Команда выведет только те строки, в начале которых встречает указанный шаблон.

Пример: `grep "^one" text.txt`

Такая команда выведет все строки, которые начинаются со слова one.

`$` — означает конец строки. Команда выведет только те строки, в конце которых встречает указанный шаблон.

Пример: `grep "one$" text.txt`

Такая команда выведет все строки, которые заканчиваются на слово one.

### Сохранение результата фильтрации в файл

Результат работы команды `grep`, как и команды `cat`, можно сохранить в файл:
```
$ grep ERROR /test1/test2/test_Logs/Log1.txt > errors.txt 
```

Все строки, в которых есть слово ERROR, сохранятся в файл `errors.txt`; содержимое файла `errors.txt` перезапишется.

### Забери с собой

Чтобы ничего не забыть, сохрани [шпаргалку](https://code.s3.yandex.net/qa-automation-engineer/java/track2/cheatsheets/sprint3/console_cheatsheet.pdf).