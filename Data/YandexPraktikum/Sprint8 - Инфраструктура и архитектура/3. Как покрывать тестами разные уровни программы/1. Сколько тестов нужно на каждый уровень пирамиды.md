Тебе удалось познакомиться с разными видами тестов: юнит-тесты, интеграционные, E2E и ручные.
Обычно в приложении больше всего юнит-тестов, а меньше всего — ручных.

В этом уроке ты узнаешь, как рассчитать примерное соотношение тестов: сколько проверок каждого вида нужно приложению.


Универсального ответа нет: всё зависит от конкретного проекта.

Представь сервис со сложной бизнес-логикой. В коде много методов — а значит, и юнит-тестов.

А может быть наоборот: архитектура простая, а вот API-методов много. Юнит-тестов получится даже меньше, чем интеграционных.

Посмотри, как распределятся тесты по уровням пирамиды в сервисе [Mesto](https://qa-mesto.praktikum-services.ru/).

Приложение состоит из нескольких слоёв:

- программный код с основными и вспомогательными методами;
- ручки и API-методы, с которыми работает фронтенд;
- UI — с ним работает пользователь через браузер.

Представь, что автотестами покрыты все три уровня. Получается, программный код покрыт юнит-тестами, ручки — интеграционными, а UI — E2E-тестами.

Чтобы считать было проще, представь, что написали только позитивные и негативные тесты. В реальности вариантов больше.

Например, поле ввода электронного адреса можно оставить пустым, ввести некорректный или несуществующий e-mail. Эти три ситуации можно назвать «негативный тест».
### Ручные тесты

Сперва функциональность Mesto проходит через ручных тестировщиков. Они готовят тест-кейсы.

Затем автоматизаторы пишут код, чтобы не проверять функциональность вручную каждый раз.

Если подходить к тестированию так, ручных тестов будет меньше всего, ведь новую функциональность проверяют вручную только один раз. Пока это единственное, что можно определить точно.

Можно сказать, во время первого релиза ручных тестов столько же, сколько E2E-тестов. Но потом их становится меньше из-за автоматизации.
### E2E-тесты

Следующий уровень пирамиды — E2E-тесты. Нужно проверить такие сценарии:

1. Проверка отображения данных на главной странице без аутентификации.
2. Регистрация.
3. Аутентификация.
4. Проверка отображения данных профиля и списка фотографий.
5. Добавление фотографии.
6. Удаление фотографии.
7. Лайк фотографии.
8. Изменение аватара профиля.
9. Изменение имени профиля.

Для сценариев 1 и 4 негативных проверок не будет: в них проверяют только корректное отображение UI.

Вспомни условие: есть только позитивные и негативные проверки. Получится **16 E2E-тестов**:

- 2 — только позитивные, потому что проверяется UI;
- 7 позитивных и 7 негативных — для остальных сценариев: по две проверки на каждый.
![img.png](img%2Fimg.png)
### Интеграционные тесты

Посмотри на доступные ручки и типы запросов, которые им соответствуют.

Каждый API-метод — отдельный сценарий для тестирования.

![img_1.png](img%2Fimg_1.png)

Для методов 3-10 нужны дополнительные негативные тесты. Они проверят, что нельзя обработать запрос без передачи токена.

Получится **28 интеграционных тестов**:

- 10 позитивных;
- 10 негативных;
- 8 негативных, связанных с аутентификацией.

![img_2.png](img%2Fimg_2.png)


### Юнит-тесты

Как ты знаешь, юнит-тесты пишут на конкретные методы.

Сейчас у тебя нет доступа к исходному коду приложения. Не получится посчитать, сколько методов используют.

Это нормально: тестировщик не всегда видит исходный код. Чаще всего юнит-тестами занимается тот, кто эти методы создаёт, — разработчик.

Ты не можешь посчитать, сколько понадобится юнит-тестов. Но можно попробовать оценить на глаз.

Например, посмотри на метод `POST /api/cards`. Он добавляет фотографии на сайт. Скорее всего, его написали так:

- обработка входящего запроса;
- валидация полей — например, для e-mail и пароля;
- заполнение моделей данных, которые соответствуют ручке — например, модель данных фотографии или пользователя;
- обработка ошибок;
- подключение к базе данных;
- добавление значения в базу;
- считывание значения из базы;
- отправка ответа.

Получилось восемь действий. Для каждого нужен отдельный метод. На каждый метод разработчик напишет юнит-тест.

Если знать, сколько методов скрывается за каждой ручкой, можно прикинуть, сколько получится юнит-тестов.

Обрати внимание, что методы обработки входящего запроса, подключения к базе данных, добавления значения в базу, считывания значения из базы и отправки ответа могут быть общими для нескольких ручек.

Примерное количество методов для всех ручек — 3 * 9 + 5 = 32 метода:

- по 3 на каждую из 9 ручек;
- 5 общих методов.