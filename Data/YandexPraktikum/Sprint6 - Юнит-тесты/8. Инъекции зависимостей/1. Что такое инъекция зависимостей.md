В этой теме ты узнаешь, что такое **зависимость** в программировании и как с ней можно работать.

Зависимость — это ситуация, когда одна сущность не работает без другой. Например, разработчик не может написать программу без компьютера.

**В программировании зависимость** (англ. dependency) означает, что один программный компонент не работает без другого. Например, класс «программист» — без класса «компьютер».

### Как зависимость выглядит в коде

Представь холодильник. Когда его дверца открывается, внутри включается свет. За свет в холодильнике отвечает лампочка. Если она не работает, свет в холодильнике не загорится. Получается, свет связан с лампочкой — это зависимость.

Этот пример легко переложить на язык Java. Пусть холодильнику в коде соответствует класс `Fridge`, а лампочке — `HorizonLamp`. Класс лампочки называется так, потому что её произвели на заводе «Горизонт».

В классе холодильника есть метод `openDoor()`. Он открывает дверцу. А класс лампочки содержит метод `switchLightOn()`, который включает свет.

Чтобы включить свет при открытии дверцы, нужно вызвать метод `switchLightOn()` для объекта `HorizonLamp` внутри класса `Fridge`:

```
public class HorizonLamp {
    // метод, который включает лампочку
    public void switchLightOn() {
        System.out.println("Лампочка загорелась");
    }
}

public class Fridge {
    // метод открывает двери
    public void openDoor() {
        // создали объект класса HorizonLamp
        HorizonLamp horizonLamp = new HorizonLamp();
        // включается свет
        horizonLamp.switchLightOn();

    }
} 
```

Чтобы в одном классе использовать методы другого, нужно создать в нём объект этого другого класса. Чтобы «холодильник» включил свет, в методе `openDoor()` создали экземпляр «лампочки».

```
// создали объект класса HorizonLamp
HorizonLamp horizonLamp = new HorizonLamp(); 
```

Класс `Fridge` зависит от `HorizonLamp`, потому что не сможет без него работать. Поэтому класс `Fridge` называют **зависимым**, а класс `HorizonLamp` — **зависимостью**.

![java_what-is-dependency-injection.png](img%2Fjava_what-is-dependency-injection.png)

### Почему зависимости плохо влияют на код

У кода с зависимостями есть ряд слабостей. У них общая причина: изменения в зависимости неизбежно ведут к изменениям в зависимом классе.

Представь: у тебя сменился поставщик лампочек и завод «Горизонт» нужно заменить на «СуперЛампочка». В коде это будут два класса, реализующие разные варианты одного интерфейса. Объект класса `HorizonLamp` поменяется на объект класса `SuperLamp`.

Ещё может произойти так, что конструктор класса `HorizonLamp` изменится. Например, у него появится новый параметр — мощность лампочки.

В обоих случаях придётся переписывать код класса `Fridge`, ведь лампочка находится прямо в нём. Это неудобно по нескольким причинам.

Каждое упоминание класса `HorizonLamp` придётся менять на `SuperLamp`. Чем чаще встречается объект, тем больше кода придётся менять. Легко что-то пропустить.

Каждый класс должен отвечать только за себя: это правило хорошего кода. Плохо, когда он затрагивает «чужие» объекты — те, которые создаются в других классах. Каждый класс следует создавать самодостаточным.

Код класса нужно менять, только если меняется его функциональность — это тоже правило хорошего тона. Чем реже меняется код класса, тем меньше вероятность, что в код попадут ошибки.

Когда будешь писать юнит-тесты на класс `Fridge`, их не получится отделить от тестов класса `HorizonLamp`. А ведь когда тестируешь функциональность, нужно проверять её и только её.

Иначе сложно обнаружить ошибку. Представь, что ты проверяешь класс «холодильник» и тест падает. Но проблема не связана с `Fridge`. На самом деле, ошибка в «лампочке» — а «холодильник» просто от неё зависит.

### Как убрать зависимость

Нужно вынести создание экземпляра `HorizonLamp` из класса `Fridge`. Класс `Fridge` должен получать объект класса `HorizonLamp` уже готовым и просто использовать его. Это и есть **инъекция зависимостей**.

**Инъекция зависимостей** (англ. Dependency Injection, или DI) — это принцип построения кода. Его ещё называют внедрением зависимостей. Термины равноправны, ты можешь использовать любой из них.

В основе принципа лежит такая идея:

Когда ты создаёшь зависимость внутри зависимого объекта, появляются сложности. Значит, нужно вынести создание зависимости из объекта в другое место. Тогда зависимость можно будет внедрить в объект в готовом виде.

Так жёсткая привязка одного компонента к другому разрывается.
![java_without-dependency-injection.png](img%2Fjava_without-dependency-injection.png)

Инъекцию зависимостей можно делать разными способами. В следующем уроке ты изучишь, как это делать с помощью конструктора.