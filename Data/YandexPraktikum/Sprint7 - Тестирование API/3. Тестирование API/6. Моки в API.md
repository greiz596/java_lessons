Тебе уже удалось написать юнит-тесты с моками.

Моки заменяют реальные сущности в коде. Их применяют, когда:

- реальный код сложно настроить,
- приложение использует внешние связи,
- нужно протестировать часть системы в изоляции.

Моки в юнит-тестах подменяют объект: через них можно настроить поведение методов объекта.

В API моки подменяют ответы стороннего сервиса.

Например, ты тестируешь сервис, который рассчитывает зарплату. Он вызывает сторонний сервис, чтобы отправить сотрудникам письма о зарплате. Сервис рассылки писем не нужно тестировать, поэтому его можно заменить моком.

Моки для API нужны, когда:

- Реальный сервис нестабилен, перегружен или не работает в часы, когда запускают тесты.
- Доступ к сервису ограничен для безопасности. Например, если для расчёта зарплаты нужно обратиться к сервису, который автоматически снимает деньги со счёта.
- Реальный сервис в разработке. Моки заменят ещё не готовую функциональность.

API нужно тестировать в условиях, близких к реальным, но в пирамиде тестирования API-тесты с моками ниже, чем тесты без изоляции. Поэтому изолированных API-автотестов в проекте должно быть больше.

Помни, что у тестирования в изоляции есть риски:

- Стороннее API может поменяться. Тесты будут проходить, но на самом деле сервис перестанет работать как должен.
- Стороннее API может работать с ошибками. Некоторые ошибки можно спрогнозировать и заложить в мок — например, долгое ожидание ответа. Но есть вероятность, что другие всё равно появятся.
- Моки нужно поддерживать в актуальном состоянии.